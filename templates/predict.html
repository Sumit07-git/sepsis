<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predict - Sepsis Early Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-heartbeat"></i>
                <span>Sepsis Prediction System</span>
            </div>
            <ul class="nav-menu">
                <li><a href="/" class="nav-link"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="/predict" class="nav-link active"><i class="fas fa-stethoscope"></i> Predict</a></li>
                <li><a href="/about" class="nav-link"><i class="fas fa-info-circle"></i> About</a></li>
            </ul>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <div class="container">
            <h1><i class="fas fa-stethoscope"></i> Sepsis Risk Assessment</h1>
            <p>Enter patient vital signs and laboratory values for AI-powered sepsis prediction</p>
        </div>
    </div>

    <div class="container">
        <div class="prediction-layout">
            <!-- Input Form -->
            <div class="prediction-form-container">
                <h2>Patient Data Input</h2>
                <form id="predictionForm" method="POST" action="/predict" class="prediction-form">
                    <div class="form-section">
                        <h3><i class="fas fa-heartbeat"></i> Vital Signs</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="HR">Heart Rate (bpm)</label>
                                <input type="number" id="HR" name="HR" class="form-control" 
                                       value="80" min="40" max="180" step="1" required>
                                <small>Normal: 60-100 bpm</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="Temp">Temperature (°C)</label>
                                <input type="number" id="Temp" name="Temp" class="form-control" 
                                       value="37" min="34" max="42" step="0.1" required>
                                <small>Normal: 36.5-37.5°C</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="Resp">Respiratory Rate (breaths/min)</label>
                                <input type="number" id="Resp" name="Resp" class="form-control" 
                                       value="16" min="8" max="40" step="1" required>
                                <small>Normal: 12-20/min</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="O2Sat">Oxygen Saturation (%)</label>
                                <input type="number" id="O2Sat" name="O2Sat" class="form-control" 
                                       value="95" min="70" max="100" step="1" required>
                                <small>Normal: >95%</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="SBP">Systolic BP (mmHg)</label>
                                <input type="number" id="SBP" name="SBP" class="form-control" 
                                       value="120" min="60" max="200" step="1" required>
                                <small>Normal: 90-120 mmHg</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="DBP">Diastolic BP (mmHg)</label>
                                <input type="number" id="DBP" name="DBP" class="form-control" 
                                       value="70" min="30" max="120" step="1" required>
                                <small>Normal: 60-80 mmHg</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="MAP">Mean Arterial Pressure (mmHg)</label>
                                <input type="number" id="MAP" name="MAP" class="form-control" 
                                       value="80" min="40" max="140" step="1" required>
                                <small>Normal: 70-100 mmHg (Auto-calculated)</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-flask"></i> Laboratory Values</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="WBC">White Blood Cell Count (×10³/μL)</label>
                                <input type="number" id="WBC" name="WBC" class="form-control" 
                                       value="8" min="1" max="30" step="0.1" required>
                                <small>Normal: 4-11 ×10³/μL</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="Platelets">Platelets (×10³/μL)</label>
                                <input type="number" id="Platelets" name="Platelets" class="form-control" 
                                       value="200" min="20" max="500" step="1" required>
                                <small>Normal: 150-400 ×10³/μL</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="Creatinine">Creatinine (mg/dL)</label>
                                <input type="number" id="Creatinine" name="Creatinine" class="form-control" 
                                       value="1.0" min="0.3" max="8" step="0.1" required>
                                <small>Normal: 0.6-1.2 mg/dL</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="Lactate">Lactate (mmol/L)</label>
                                <input type="number" id="Lactate" name="Lactate" class="form-control" 
                                       value="1.5" min="0.5" max="10" step="0.1" required>
                                <small>Normal: 0.5-2.2 mmol/L</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-large">
                            <i class="fas fa-calculator"></i> Calculate Risk
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="loadSepsisExample()">
                            <i class="fas fa-exclamation-triangle"></i> Sepsis Example
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="loadNormalExample()">
                            <i class="fas fa-check"></i> Normal Example
                        </button>
                    </div>
                </form>
            </div>

            <!-- Quick Info Panel -->
            <div class="prediction-result">
                <h2>Quick Reference</h2>
                
                <div class="risk-details">
                    <h4><i class="fas fa-info-circle"></i> About This Assessment</h4>
                    <p>This AI-powered system analyzes patient vital signs and laboratory values to predict sepsis risk using:</p>
                    <ul>
                        <li>Random Forest machine learning model</li>
                        <li>SOFA and SIRS clinical scoring</li>
                        <li>32 engineered clinical features</li>
                        <li>Evidence-based risk thresholds</li>
                    </ul>

                    <h4><i class="fas fa-flag"></i> Risk Categories</h4>
                    <ul>
                        <li><strong>VERY HIGH (≥70%):</strong> Critical risk, immediate intervention</li>
                        <li><strong>HIGH (50-69%):</strong> Elevated risk, urgent review needed</li>
                        <li><strong>MODERATE (30-49%):</strong> Some concerns, enhanced monitoring</li>
                        <li><strong>LOW (&lt;30%):</strong> Minimal risk, routine care</li>
                    </ul>

                    <h4><i class="fas fa-heartbeat"></i> Normal Ranges</h4>
                    <ul>
                        <li><strong>Heart Rate:</strong> 60-100 bpm</li>
                        <li><strong>Temp:</strong> 36.5-37.5°C</li>
                        <li><strong>Resp Rate:</strong> 12-20/min</li>
                        <li><strong>O2 Sat:</strong> >95%</li>
                        <li><strong>SBP:</strong> 90-120 mmHg</li>
                        <li><strong>MAP:</strong> 70-100 mmHg</li>
                        <li><strong>WBC:</strong> 4-11 ×10³/μL</li>
                        <li><strong>Platelets:</strong> 150-400 ×10³/μL</li>
                        <li><strong>Creatinine:</strong> 0.6-1.2 mg/dL</li>
                        <li><strong>Lactate:</strong> 0.5-2.2 mmol/L</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Sepsis Early Prediction System | Machine Learning for Healthcare</p>
            <p class="disclaimer">This system is for educational and research purposes only. Not for clinical use.</p>
        </div>
    </footer>

    <script>
        // Auto-calculate MAP from SBP and DBP
        document.getElementById('SBP').addEventListener('input', calculateMAP);
        document.getElementById('DBP').addEventListener('input', calculateMAP);

        function calculateMAP() {
            const sbp = parseFloat(document.getElementById('SBP').value);
            const dbp = parseFloat(document.getElementById('DBP').value);
            
            if (!isNaN(sbp) && !isNaN(dbp)) {
                const map = Math.round((sbp + 2 * dbp) / 3);
                document.getElementById('MAP').value = map;
            }
        }

        function loadSepsisExample() {
            document.getElementById('HR').value = 118;
            document.getElementById('Temp').value = 38.8;
            document.getElementById('Resp').value = 26;
            document.getElementById('O2Sat').value = 89;
            document.getElementById('SBP').value = 85;
            document.getElementById('DBP').value = 52;
            document.getElementById('MAP').value = 63;
            document.getElementById('WBC').value = 16.5;
            document.getElementById('Platelets').value = 95;
            document.getElementById('Creatinine').value = 2.3;
            document.getElementById('Lactate').value = 4.2;
        }

        function loadNormalExample() {
            document.getElementById('HR').value = 75;
            document.getElementById('Temp').value = 36.8;
            document.getElementById('Resp').value = 14;
            document.getElementById('O2Sat').value = 98;
            document.getElementById('SBP').value = 125;
            document.getElementById('DBP').value = 75;
            document.getElementById('MAP').value = 92;
            document.getElementById('WBC').value = 7.2;
            document.getElementById('Platelets').value = 240;
            document.getElementById('Creatinine').value = 0.9;
            document.getElementById('Lactate').value = 1.1;
        }
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>